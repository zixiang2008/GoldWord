<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>GoldWord ä¸‹è½½ä¸­å¿ƒ - CDNåŠ é€Ÿ</title>
  <style>
    body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;margin:0;background:#fff;color:#333}
    .wrap{max-width:980px;margin:0 auto;padding:24px}
    h1{font-size:24px;margin:0 0 12px}
    .ver{font-size:14px;color:#666;margin-bottom:16px}
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    .card{border:1px solid #e5e5e5;border-radius:12px;padding:14px;background:#fafafa;transition:all .2s}
    .card:hover{box-shadow:0 2px 8px rgba(0,0,0,.08);transform:translateY(-1px)}
    .card h3{margin:0 0 8px;font-size:16px}
    .card .desc{font-size:13px;color:#666;margin-bottom:8px}
    .card .size-info{font-size:12px;color:#999;margin-bottom:8px}
    .card .cdn-badge{display:inline-block;background:#ff6b35;color:#fff;padding:2px 6px;border-radius:4px;font-size:11px;margin-bottom:8px}
    .card .download-group{display:flex;gap:8px;flex-wrap:wrap}
    .card a{display:inline-block;padding:8px 12px;border-radius:8px;text-decoration:none;font-size:13px;font-weight:500;transition:all .2s}
    .card .cdn-link{background:#007aff;color:#fff}
    .card .cdn-link:hover{background:#0056b3}
    .card .github-link{background:#24292e;color:#fff}
    .card .github-link:hover{background:#1a1e22}
    .note{margin-top:20px;font-size:13px;color:#555;background:#f8f9fa;padding:16px;border-radius:8px}
    .cdn-notice{background:#e8f4fd;border:1px solid #b3d7f0;color:#0066cc;padding:12px;border-radius:8px;margin-bottom:16px;font-size:14px}
    .cdn-notice strong{color:#004499}
    @media(max-width:720px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:460px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>GoldWord ä¸‹è½½ä¸­å¿ƒ</h1>
    <div class="ver" id="ver">å½“å‰ç‰ˆæœ¬ï¼š</div>
    
    <div class="cdn-notice">
      <strong>ğŸš€ CDNåŠ é€Ÿä¸‹è½½</strong><br>
      æ‰€æœ‰ä¸‹è½½æ–‡ä»¶å·²é€šè¿‡CloudFlare CDNå…¨çƒåŠ é€Ÿï¼Œä¸‹è½½é€Ÿåº¦æå‡æ˜¾è‘—ã€‚å¦‚é‡é—®é¢˜ï¼Œä»å¯é€šè¿‡GitHubåŸå§‹é“¾æ¥ä¸‹è½½ã€‚
    </div>
    
    <div class="grid" id="grid"></div>
    
    <div class="note">
      <div style="font-weight:600;margin-bottom:6px">ä½¿ç”¨æŒ‡å¼•</div>
      <div class="info-grid">
        <div class="info-card"><div class="info-icon i-mac">ğŸ</div><div><div style="font-weight:600;color:#007aff">macOS å®‰è£…åŒ….app</div><div style="color:#555">è§£å‹å¾—åˆ° <span style="font-family:monospace">GoldWord.app</span>ï¼Œæ‹–å…¥"åº”ç”¨ç¨‹åº"ã€‚å¦‚æç¤ºæœªçŸ¥å¼€å‘è€…ï¼šç³»ç»Ÿè®¾ç½®â†’éšç§ä¸å®‰å…¨â†’å…è®¸ã€‚</div></div></div>
        <div class="info-card"><div class="info-icon i-mac">ğŸ</div><div><div style="font-weight:600;color:#007aff">macOS å®‰è£…åŒ…ï¼ˆDMGï¼‰</div><div style="color:#555">æ‰“å¼€ DMGï¼Œå°†åº”ç”¨æ‹–å…¥"åº”ç”¨ç¨‹åº"ã€‚é¦–æ¬¡è¿è¡Œå‚è€ƒä¸Šæ–¹å…è®¸æ­¥éª¤ã€‚</div></div></div>
        <div class="info-card"><div class="info-icon i-android">ğŸ¤–</div><div><div style="font-weight:600;color:#22c55e">Android å¹³æ¿ç‰ˆ APK</div><div style="color:#555">åœ¨å¹³æ¿è®¾å¤‡å®‰è£… APKï¼Œè®¾ç½®"å…è®¸æœªçŸ¥æ¥æº"ã€‚é€‚é…å¤§å±æ¨ªå±ä½“éªŒã€‚</div></div></div>
        <div class="info-card"><div class="info-icon i-android">ğŸ“±</div><div><div style="font-weight:600;color:#22c55e">Android æ‰‹æœºç‰ˆ APK</div><div style="color:#555">æ‰‹æœºå®‰è£… APKï¼Œæˆäºˆè¯­éŸ³æƒé™ä»¥ä½¿ç”¨æœ—è¯»åŠŸèƒ½ã€‚</div></div></div>
        <div class="info-card"><div class="info-icon i-ipad">ğŸ§¿</div><div><div style="font-weight:600;color:#5856d6">iPad å®‰è£…åŒ…ï¼ˆIPAï¼‰</div><div style="color:#555">ä¼ä¸š/æµ‹è¯•åˆ†å‘ï¼šSafari å®‰è£…åï¼Œè®¾ç½®â†’é€šç”¨â†’è®¾å¤‡ç®¡ç†â†’ä¿¡ä»»è¯ä¹¦ã€‚</div></div></div>
        <div class="info-card"><div class="info-icon i-win">âŠ</div><div><div style="font-weight:600;color:#333">Windows å®‰è£…åŒ…</div><div style="color:#555">ä¸‹è½½ EXE æˆ– ZIPã€‚å¦‚è¢«æ‹¦æˆªé€‰æ‹©"ä»è¦è¿è¡Œ/ä¿ç•™"ã€‚ZIP è§£å‹ååŒå‡»è¿è¡Œã€‚</div></div></div>
        <div class="info-card"><div class="info-icon i-mac">ğŸ</div><div><div style="font-weight:600;color:#8e8e93">macOS å®‰è£…åŒ…ï¼ˆZIPï¼‰</div><div style="color:#555">è§£å‹å¾—åˆ°åº”ç”¨æˆ–å®¹å™¨ï¼Œæ‹–å…¥"åº”ç”¨ç¨‹åº"ã€‚é€‚åˆæ— æ³•æŒ‚è½½ DMG çš„ç¯å¢ƒã€‚</div></div></div>
      </div>
    </div>
  </div>
  
  <script>
  (async function(){
    const CDN_BASE = 'https://caishen.us.kg';
    const GITHUB_BASE = 'https://github.com/zixiang2008/GoldWord/releases/download';
    
    const verEl = document.getElementById('ver');
    const grid = document.getElementById('grid');
    
    function fmtSize(bytes) { 
      if(!bytes && bytes!==0) return ''; 
      const u=['B','KB','MB','GB']; 
      let i=0; 
      let v=Number(bytes); 
      while(v>=1024&&i<u.length-1){ v/=1024; i++; } 
      return `${v.toFixed(i?2:0)} ${u[i]}`; 
    }
    
    function fmtDate(s) { 
      try{ 
        const d=new Date(s); 
        if(isNaN(d.getTime())) return ''; 
        const y=d.getFullYear(); 
        const m=String(d.getMonth()+1).padStart(2,'0'); 
        const da=String(d.getDate()).padStart(2,'0'); 
        const hh=String(d.getHours()).padStart(2,'0'); 
        const mm=String(d.getMinutes()).padStart(2,'0'); 
        return `${y}-${m}-${da} ${hh}:${mm}`; 
      } catch(_) { 
        return ''; 
      } 
    }
    
    function createDownloadCard(title, description, cdnUrl, githubUrl, size, mtime, fileName) {
      const card = document.createElement('div');
      card.className = 'card';
      
      const h3 = document.createElement('h3');
      h3.textContent = title;
      card.appendChild(h3);
      
      if(description) {
        const desc = document.createElement('div');
        desc.className = 'desc';
        desc.textContent = description;
        card.appendChild(desc);
      }
      
      if(size || mtime) {
        const sizeInfo = document.createElement('div');
        sizeInfo.className = 'size-info';
        sizeInfo.textContent = `æ–‡ä»¶å¤§å°ï¼š${size ? fmtSize(size) : 'â€”'} ï½œ æ›´æ–°æ—¶é—´ï¼š${mtime ? fmtDate(mtime) : 'â€”'}`;
        card.appendChild(sizeInfo);
      }
      
      const badge = document.createElement('div');
      badge.className = 'cdn-badge';
      badge.textContent = 'CDNåŠ é€Ÿ';
      card.appendChild(badge);
      
      const downloadGroup = document.createElement('div');
      downloadGroup.className = 'download-group';
      
      if(cdnUrl) {
        const cdnLink = document.createElement('a');
        cdnLink.href = cdnUrl;
        cdnLink.className = 'cdn-link';
        cdnLink.textContent = 'CDNä¸‹è½½';
        cdnLink.target = '_blank';
        downloadGroup.appendChild(cdnLink);
      }
      
      if(githubUrl) {
        const githubLink = document.createElement('a');
        githubLink.href = githubUrl;
        githubLink.className = 'github-link';
        githubLink.textContent = 'GitHubä¸‹è½½';
        githubLink.target = '_blank';
        downloadGroup.appendChild(githubLink);
      }
      
      card.appendChild(downloadGroup);
      return card;
    }
    
    function createFeedbackCard() {
      const card = document.createElement('div');
      card.className = 'card';
      
      const h3 = document.createElement('h3');
      h3.textContent = 'å¿«é€Ÿåé¦ˆ';
      card.appendChild(h3);
      
      const p = document.createElement('div');
      p.textContent = 'æäº¤é—®é¢˜ä¸å»ºè®®';
      card.appendChild(p);
      
      const a = document.createElement('a');
      a.href = 'https://github.com/zixiang2008/GoldWord/issues';
      a.textContent = 'æ‰“å¼€ Issues';
      a.target = '_blank';
      a.className = 'github-link';
      card.appendChild(a);
      
      return card;
    }
    
    try {
      const latest = await fetch('downloads/latest.json').then(r => r.json());
      const version = latest.latest;
      verEl.textContent = `å½“å‰ç‰ˆæœ¬ï¼š${version}`;
      
      const info = await fetch(`downloads/${version}/index.json`).then(r => r.json());
      const items = Array.isArray(info.items) ? info.items : [];
      
      // è·å–CDNé“¾æ¥æ˜ å°„
      let cdnLinks = [];
      try {
        cdnLinks = await fetch('cdn-links-generated.json').then(r => r.json());
      } catch(e) {
        console.warn('CDNé“¾æ¥æ˜ å°„æ–‡ä»¶åŠ è½½å¤±è´¥ï¼Œå°†ä½¿ç”¨GitHubé“¾æ¥');
      }
      
      function getCdnUrl(fileName) {
        const cdnItem = cdnLinks.find(item => item.filename === fileName);
        return cdnItem ? cdnItem.cdnUrl : null;
      }
      
      function getGithubUrl(fileName) {
        return `${GITHUB_BASE}/v${version}/${encodeURIComponent(fileName)}`;
      }
      
      // æ˜ å°„ä¸åŒç±»å‹çš„ä¸‹è½½é¡¹
      const downloads = {
        'mac-app': {
          title: 'macOS å®‰è£…åŒ….app',
          description: 'è§£å‹å¾—åˆ° GoldWord.appï¼Œæ‹–å…¥"åº”ç”¨ç¨‹åº"',
          files: items.filter(x => x.type === 'mac' && x.name.includes('.app.zip'))
        },
        'mac-dmg': {
          title: 'macOS å®‰è£…åŒ…ï¼ˆDMGï¼‰',
          description: 'æ‰“å¼€DMGï¼Œå°†åº”ç”¨æ‹–å…¥"åº”ç”¨ç¨‹åº"',
          files: items.filter(x => x.type === 'mac' && x.name.includes('.dmg'))
        },
        'mac-zip': {
          title: 'macOS å®‰è£…åŒ…ï¼ˆZIPï¼‰',
          description: 'è§£å‹å¾—åˆ°åº”ç”¨ï¼Œé€‚åˆæ— æ³•æŒ‚è½½DMGçš„ç¯å¢ƒ',
          files: items.filter(x => x.type === 'mac' && x.name.includes('.zip') && !x.name.includes('.app.zip'))
        },
        'android-pad': {
          title: 'Android å¹³æ¿ç‰ˆ APK',
          description: 'é€‚é…å¤§å±æ¨ªå±ä½“éªŒ',
          files: items.filter(x => x.type === 'android-pad')
        },
        'android-phone': {
          title: 'Android æ‰‹æœºç‰ˆ APK',
          description: 'æ‰‹æœºå®‰è£…ï¼Œæˆäºˆè¯­éŸ³æƒé™ä»¥ä½¿ç”¨æœ—è¯»åŠŸèƒ½',
          files: items.filter(x => x.type === 'android-phone')
        },
        'ipad': {
          title: 'iPad å®‰è£…åŒ…ï¼ˆIPAï¼‰',
          description: 'ä¼ä¸š/æµ‹è¯•åˆ†å‘ï¼Œéœ€ä¿¡ä»»è¯ä¹¦',
          files: items.filter(x => x.type === 'ipad')
        },
        'win': {
          title: 'Windows å®‰è£…åŒ…',
          description: 'EXEæˆ–ZIPæ ¼å¼ï¼Œå¦‚è¢«æ‹¦æˆªé€‰æ‹©"ä»è¦è¿è¡Œ"',
          files: items.filter(x => x.type === 'win')
        }
      };
      
      // ä¸ºæ¯ä¸ªç±»å‹åˆ›å»ºä¸‹è½½å¡ç‰‡
      for(const [key, config] of Object.entries(downloads)) {
        if(config.files.length > 0) {
          const file = config.files[0]; // å–ç¬¬ä¸€ä¸ªæ–‡ä»¶
          const cdnUrl = getCdnUrl(file.name);
          const githubUrl = getGithubUrl(file.name);
          
          const card = createDownloadCard(
            config.title,
            config.description,
            cdnUrl,
            githubUrl,
            file.size,
            file.mtime,
            file.name
          );
          
          grid.appendChild(card);
        }
      }
      
      // æ·»åŠ åé¦ˆå¡ç‰‡
      grid.appendChild(createFeedbackCard());
      
    } catch(e) {
      console.error('åŠ è½½å¤±è´¥:', e);
      verEl.textContent = 'åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•';
    }
  })()
  </script>
</body>
</html>