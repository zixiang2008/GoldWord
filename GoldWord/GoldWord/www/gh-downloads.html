<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>GoldWord 下载中心</title>
  <style>
    body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;margin:0;background:#fff;color:#333}
    .wrap{max-width:980px;margin:0 auto;padding:24px}
    h1{font-size:24px;margin:0 0 12px}
    .ver{font-size:14px;color:#666;margin-bottom:16px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .card{border:1px solid #e5e5e5;border-radius:12px;padding:14px;background:#fafafa}
    .card h3{margin:0 0 8px;font-size:16px}
    .card a{display:inline-block;margin-top:8px;padding:8px 10px;border-radius:8px;background:#007aff;color:#fff;text-decoration:none}
    .note{margin-top:20px;font-size:13px;color:#555}
    @media(max-width:720px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:460px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>GoldWord 下载中心</h1>
    <div class="ver" id="ver">加载版本信息…</div>
    <div class="grid" id="grid"></div>
    <div class="note">
      <div>Android：下载 APK 后在设备上启用允许安装未知来源，安装并授予语音权限。</div>
      <div>Windows：下载 EXE 安装包；如被拦截，请选择仍要保留/运行。</div>
      <div>macOS：下载 DMG 或 ZIP；首次运行如提示来自未知开发者，请在系统设置→安全性与隐私允许。</div>
      <div>iPad：如为企业签名或测试分发，Safari 安装后在 设置→通用→设备管理 信任证书。</div>
    </div>
  </div>
  <script>
  (async function(){
    const verEl=document.getElementById('ver');
    const grid=document.getElementById('grid');
    function card(title, name, url){
      const c=document.createElement('div');c.className='card';
      const h=document.createElement('h3');h.textContent=title; c.appendChild(h);
      if(name&&url){ const p=document.createElement('div');p.textContent=name; const a=document.createElement('a'); a.href=url; a.textContent='下载'; c.appendChild(p); c.appendChild(a); }
      else { const p=document.createElement('div'); p.textContent='暂未提供该平台的下载包'; c.appendChild(p); }
      grid.appendChild(c);
    }
    try{
      const cfg = await fetch('downloads/config.json').then(r=>r.json()).catch(()=>null);
      if(!cfg||!cfg.owner||!cfg.repo){ verEl.textContent='未配置仓库'; return }
      const rel = await fetch(`https://api.github.com/repos/${cfg.owner}/${cfg.repo}/releases/latest`).then(r=>r.json());
      const assets = Array.isArray(rel.assets) ? rel.assets : [];
      verEl.textContent = `当前版本：${rel.tag_name||rel.name||''}`;
      const pick=(re)=> assets.find(a=> re.test(a.name));
      const phone = pick(/Android-Phone/i);
      const pad   = pick(/Android-Pad/i);
      const win   = pick(/win-setup/i);
      const macD  = pick(/mac-.*\.dmg/i);
      const macZ  = pick(/mac-.*\.zip/i);
      const ipad  = pick(/iPad.*\.ipa/i);
      card('Android 手机版 APK', phone?.name, phone?.browser_download_url);
      card('Android 平板版 APK', pad?.name, pad?.browser_download_url);
      card('iPad 安装包（IPA）', ipad?.name, ipad?.browser_download_url);
      card('Windows 安装包', win?.name, win?.browser_download_url);
      card('macOS 安装包', (macD?.name||macZ?.name), (macD?.browser_download_url||macZ?.browser_download_url));
    }catch(e){ verEl.textContent='加载失败' }
  })()
  </script>
</body>
</html>
